#!/usr/bin/env ruby

require 'lib/crisp'

runtime = Crisp::Runtime.new

if ARGV.size == 0
  buffer = ''

  loop do
    print ">> " if buffer.empty?
    buffer << gets

    if ast = Crisp::Parser.new.parse(buffer)
      puts "=> " + runtime.run(ast).to_s
      buffer = ''
    else
      print "?> "
    end
  end
elsif ARGV.size == 1
  if ast = Crisp::Parser.new.parse(File.read(ARGV[0]))
    runtime.run(ast).to_s
  else
    raise "something is wrong with the code"
  end
else
  puts "to many args"
  exit 1
end
